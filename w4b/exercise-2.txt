a) In case the inbound ICMP Error messages belong to an exisiting NAT session then the following should happen: 

-- The destination IP address of the outer IP header should be changed to be equal to the source IP address of the embedded packet after translation
-- With the usage of matching mapping, the IP and transport headers of the embedded IP packet should be reverted to their original value
-- The ICMP Error type and code should be left unchanged

With this approach, the possibility for the information contained by the ICMP error message to be malicious is minimized.

b) ICMP Error messages provide an error response in case a preceding IP packet that was sent is unable to reach it's host. When the IP packed was initially sent, a NAT session is established stating that the incomming ICMP error message can be trusted. However, these are cases when an incoming ICMP Error message does not have a preceding IP packet, so no NAT session is established to guarantee the safety of the ICMP error message. Most of the time these ICMP error messages are used as malicious attacks and they should be dropped.  

c) In case the outbound ICMP Error messages belong to an exisiting NAT session then the following should happen:

-- With the usage of matching mapping, the IP and transport headers of the embedded IP packet should be reverted to their original value
-- The ICMP Error type and code should be left unchanged
-- The source IP address of the ICMP error message should be translate to the public IP address in the mapping. This happens only if the NAT imposes the Basic NAT function && NAT has active mapping for the IP address which sent the ICMP error message.

d) Since there is no preceding event which might have caused the generation of the ICMP Error Message, there is a high probability that the ICMP error message is malicious. Therefore, the outbound ICMP Error messages without an existing NAT session should be dropped. 

e) Some possible security concerns: 

-- A malicious host could overflow the NAT device with a enormous amount of ICMP Error messages. In case, the authenticity of these ICMP error message is not certified by the NAT then the bogus ICMP Errors messages will be forwarded to the end host. To mitigate this, before forwarding the ICMP checksum and IP checksum must be validated. These validations will prevent the end hosts from malicious ICMP error messages. 

-- A bogus source might send malignant ICMP Error Messages for the active sessions of NAT. The purpose would be to crush these sessions. According to Req-6, this attack can be mitigated by guaranteeing that the ICMP error message does not refresh or delete the NAT session.  

-- Admins may decide not send ICMP error messages from the NAT device. This may serve as a confirmation to the attacker that the attack went through. As a consequence, the decision to send specific ICMP Error messages is left to the admins of NAT. 
