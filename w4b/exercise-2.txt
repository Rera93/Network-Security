a) + b) According to the official rfc, icmp error messages are defined as following: "ICMP Error messages provide signaling for IP. All ICMP Error messages are characterized by the fact that they embed the original datagram that triggered the ICMP Error message. The original datagram embedded within the ICMP Error payload is also referred to as the 'Embedded packet' throughout the document". As stated before, icmp error messages provide an error response if, i.e. an ip package cannot reach its host. Therefore, a preceding ip package has to be sent prior to get an icmp error message. This preceding ip package created a nat mapping/session, stating that the incoming icmp error message can be trusted. A incoming icmp error message without a preceding ip packet and therefore no nat mapping/session should be dropped, because it has no proper cause to enter the private realm. Most of the time such icmp error messages without a nat mapping/session are used for malicious attacks, therefore they should be dropped. According to the official rfc, inbound icmp error messages which belong to an existing NAT session should be treated as following:

	* a) Revert the IP and transport headers of the embedded IP packet to their original form, using the matching mapping; and
	* b) Leave the ICMP Error type and code unchanged; and
	* c) Modify the destination IP address of the outer IP header to be same as the source IP address of the embedded packet after translation.
	
This gives the sender inside the private realm the possibility to get all information a icmp error message provides with a minimal chance of the icmp error message of malicious nature. 
Option a and b guarantee that the host inside the private realm receives the icmp error message and does not get stuck at the router's ip.

c) + d) According to the official rfc, outbound icmp error messages which belong to an existing NAT session should be treated as following:
	a) Revert the IP and transport headers of the embedded IP packet to their original form, using the matching mapping; and
	b) Leave the ICMP Error type and code unchanged; and
	c) If the NAT enforces Basic NAT function [NAT-TRAD], and the NAT has active mapping for the IP address that sent the ICMP Error, translate the source IP address of the ICMPError packet with the public IP address in the mapping. In all other cases, translate the source IP address of the ICMP Error packet with its own public IP address.

Outbound icmp error messages without an existing nat session/mapping should be dropped because there was no preceding event which could have caused the creation of the error message in the first place. Therefore there is a high chance that such an icmp error message is of malicious nature. Option a and c are standard nat procedures so that the IP address of the router of the external realm is exchanged for the source ip address of the host in the private realm.


e) + f) 

f) 