a) In case the inbound ICMP Error messages belong to an exisiting NAT session then the following should happen: 

-- The destination IP address of the outer IP header should be changed to be equal to the source IP address of the embedded packet after translation
-- With the usage of matching mapping, the IP and transport headers of the embedded IP packet should be reverted to their original value
-- The ICMP Error type and code should be left unchanged

With this approach, the possibility for the information contained by the ICMP error message to be malicious is minimized.

b) ICMP Error messages provide an error response in case a preceding IP packet that was sent is unable to reach it's host. When the IP packed was initially sent, a NAT session is established stating that the incomming ICMP error message can be trusted. However, these are cases when an incoming ICMP Error message does not have a preceding IP packet, so no NAT session is established to guarantee the safety of the ICMP error message. Most of the time these ICMP error messages are used as malicious attacks and they should be dropped.  

c) In case the outbound ICMP Error messages belong to an exisiting NAT session then the following should happen:

-- With the usage of matching mapping, the IP and transport headers of the embedded IP packet should be reverted to their original value
-- The ICMP Error type and code should be left unchanged
-- The source IP address of the ICMP error message should be translate to the public IP address in the mapping. This happens only if the NAT imposes the Basic NAT function && NAT has active mapping for the IP address which sent the ICMP error message.

d) Since there is no preceding event which might have caused the generation of the ICMP Error Message, there is a high probability that the ICMP error message is malicious. Therefore, the outbound ICMP Error messages without an existing NAT session should be dropped. 

e) + f) There are three different kinds of icmp messages, namely "ICMP Query Messages", "ICMP Error Messages" and "Non-QueryError ICMP Messages". ICMP Query messages are characterized by an identifier field in the ICMP header which is also called "Query Identifier" or "Query Id". Such a Query Id is used for creating a nat mapping. The internal query id gets replaces by an external id which the nat device has to remember to process the nat session later on. An ICMP Error message does not provide such a "Query Id". It provides signaling for IP and is characterized by the fact that it contains the datagram which triggered the ICMP error message in the first place. A nat mapping is only possible by inspecing the contained datagram and create a nat mapping on this information. I guess the ip addresses of the contained datagram are getting exchanged (external <-> internal) and this replacement is saved by the nat device which therefore assigns it a session. As the name suggests "Non-QueryError ICMP Messages" is a separated, third class of its own and according to the rfc chapter 8, there is no official way of handling it a nat environment: REQ-11: A NAT MAY drop or appropriately handle Non-QueryError´ICMP messages. The semantics of Non-QueryError ICMP messages is defined in Section 2.
		Possible attacks:
			* Smurf attack: A DDoS attack where a large number if ICMP packets with the victim's spoofed ip address as source is broadcasted to a network. If the network contains a large number of devices which answer the ICMP packet's source address, the victim gets flooded with traffic which can slow down the victim's computer. Mitigation: Configure individual hosts and routers to not respond to ICMP requests or broadcasts. Configure routers to not forward packets directed to broadcast addresses
			* Ping of death: An attacker sends an ICMP echo request packet that's larger than the maximum IP packet size. Since the received ICMP echo request packet is larger than the normal IP packet size, it's fragmented. The target can't reassemble the packets, so the OS crashes or reboots. Mitigation: Selectively block fragmented pings, allowing actual ping traffic to pass through unhindered.
			* ICMP flood attack: A broadcast storm of pings overwhelms the target system so it can't respond to legitimate traffic. Mitigation: Limiting the size of ping requests as well as the rate at which they can be accepted. 