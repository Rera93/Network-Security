a) IP spoofing describes the process of altering the header information of an IP packet especially the source addrress. The Internet protocol (IP) is a network protocol operating at layer 3 (network) of the OSI model. It is a connectionless model which means that there is no information regarding transaction state. Additionally, there is no method to ensure that a packet is properly delivered to the destination. By altering the source address field of the ip packets, an attacker can disguise his original ip address and can use this technique for various attack scenarios. There are two main scenarios for IP spoofing: the attacker sits on the same subnet and the attacker sits outside the subnet of his victim. If the attacker sits outside the subnet then most of the time the attack is blind ip spoofing because there is no way to catch reponding ip packets. If the attacker sits inside the same subnet then it is called non-blind ip spoofing. If non-blind ip spoofing is applied then most of the time the machine with the spoofed ip is attacked by some sort of DoS attack, so the attacker can fetch the responding ip packets which were originally meant for the spoofed machine.

b) The Internet protocol (IP) operates at layer 3 (network) and takes care of addressing and routing. TCP and UDP operate on layer 4 (transport) and are responsible for reliable transmissions of data segments between points on a network. The Internet Protool is a wrapper for layer 4. In other words, TCP/UDP are contained inside an IP packet's data segment. TCP and UDP incorporate a pseudo header. The pseudo header is prefixed to the UDP or TCP header and contains source address, the destination address, protocol length and the protocol id. The source and destination address are taken from the ip header. In order to calculate the checksum, both UDP and TCP are using the pseudo header and the whole protocol segment.

In case, the IP spoofing is being used with a TCP or UDP protocol within the data segment of the IP packet AND the source address in the ip header is changed, then the checksum of the UDP or TCP segment has to be re-calculated. On the other hand, if the previous condition is not true that the receiving part will dump the packet.

Additionally, a problem can arise when IP spoofing is used with the TCP protocol. TCP sessions have to build a connection by using the 3-way-handshake beforehand to establish such a valid session by using sequences(SEQ) and acknowledgements(ACK). The above mentioned procedure increases the reliability of data since the sender receives an OK message from the recipient after each packet exchange. Furthermore, most of the time the attacker won't get back any response based on the false ip thus by making the three-way-handshake difficult to establish between a given host and a spoofed IP.



c) The main idea behind the SYN flooding attack is sending many SYN packets to the server and never reply to the server's SYN/ACK with an ACK. This way the server's SYN queue will fill up to the point that new connections can't be established. Let's use the given scenario where Mallory tries to SYN flood Alice by ip spoofing Bob's address. Mallory is sending an initial SYN with a given sequence number X to Alice with the spoofed ip of Bob. Alice answers the initial response with a SYN/ACK with a new sequence number and the acknowledgment of X + 1. The responding SYN/ACK is now flowing to the spoofed ip which belongs to Bob, Mallory therefore does not get the response. Bob receives a SYN/ACK with an acknowledgment number he can't recognize and can't find the corresponding sequence number. Bob therefore sends a RST and forces the connection to close. The allocated memory in the SYN queue of Alice gets free and the SYN flooding attack does not succeed. 

d) d) When Mallory tries to send SYN to Alice then the packet most likely has to be routed by some sort of gateway or switch. A switch has a routing table most of the time which preserves currently active hosts with their MAC and IP addresses. The routing table gets updated by the ICMP protocol in certain scenarios and if a certain destination address cannout be found, the ICMP packet carries a response code of 1 which means "host unreachable". This scenario causes the current attack to fail because the victim of the SYN flooding does not have to allocate any memory on the SYN queue based on its knowledge that the target of the SYN/ACK response is unreachable.

e) Assume Bob is on the same subnet as Mallory and Alice. Mallory starts a man-in-the-middle attack by ARP spoofing both Bob and Alice. All traffic between Bob and Alice is therefore redirected through Mallory. Mallory is able to alter packages between these two hosts. Mallory start to SYN flooding Alice with the spoofed IP of Bob. Alice receives the SYNs, allocates memory on the SYN queue and sends a SYN/ACK back to Bob's ip address. The incoming SYN/ACK is intercepted by Alice and discarded which forces the before mentioned memory to stay allocated. In this way Mallory stays anonymous in this attack, can use Bob's ip address and can succeed with the SYN flooding attack.

